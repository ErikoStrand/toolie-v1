<!DOCTYPE html>
<html>
  <head>
    <title>Customizable Timer</title>
    <style>
      body {
        text-align: center;
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        background-color: #f0f0f0;
      }
      #timer {
        font-size: 48px;
        margin: 20px;
        font-variant-numeric: tabular-nums;
        cursor: pointer;
        border: 1px dashed transparent;
        width: 200px;
        text-align: center;
        letter-spacing: 1px;
        display: inline-block;
      }
      #timer:focus {
        outline: none;
        border-color: #007bff;
      }
      input,
      button {
        margin: 10px;
        padding: 10px;
        font-size: 16px;
      }
    </style>
  </head>
  <body>
    <div id="timer" contenteditable="true">00:00:00</div>
    <div>
      <button id="startBtn">Start Timer</button>
      <button id="stopBtn" disabled>Stop Timer</button>
      <button id="resetBtn">Reset Timer</button>
    </div>

    <script>
      const timerDisplay = document.getElementById("timer");
      const startBtn = document.getElementById("startBtn");
      const stopBtn = document.getElementById("stopBtn");
      const resetBtn = document.getElementById("resetBtn");

      let timer;
      let totalSeconds = 0;
      let isRunning = false;

      function getSeconds(formatTime) {
        const time = formatTime.split(":");
        if (time.length === 3) {
          return (
            Number(time[0]) * 3600 +
            Number(time[1]) * 60 +
            Number(time[2])
          );
        }
        return 0; // Default if invalid input
      }

      function playNotification() {
        console.log("Time's up!");
      }

      startBtn.addEventListener("click", () => {
        const enteredTime = timerDisplay.textContent.trim();
        totalSeconds = getSeconds(enteredTime);

        if (totalSeconds > 0 && !isRunning) {
          startTimer();
        }
      });

      stopBtn.addEventListener("click", () => {
        clearInterval(timer);
        isRunning = false;
        startBtn.disabled = false;
        stopBtn.disabled = true;
        timerDisplay.setAttribute("contenteditable", "true");
      });

      resetBtn.addEventListener("click", () => {
        clearInterval(timer);
        totalSeconds = 0;
        isRunning = false;
        resetTimerDisplay();
      });

      timerDisplay.addEventListener("click", () => {
        if (isRunning) {
          clearInterval(timer);
          isRunning = false;
          startBtn.disabled = false;
          stopBtn.disabled = true;
          timerDisplay.setAttribute("contenteditable", "true");
        }
      });

      function startTimer() {
        isRunning = true;
        startBtn.disabled = true;
        stopBtn.disabled = false;
        timerDisplay.setAttribute("contenteditable", "false");

        timer = setInterval(() => {
          if (totalSeconds > 0) {
            totalSeconds--;
            updateTimerDisplay();
          } else {
            clearInterval(timer);
            playNotification();
            resetTimerDisplay();
          }
        }, 1000);
      }

      function updateTimerDisplay() {
        const hours = Math.floor(totalSeconds / 3600);
        const minutes = Math.floor((totalSeconds % 3600) / 60);
        const seconds = totalSeconds % 60;

        timerDisplay.textContent = `${hours
          .toString()
          .padStart(2, "0")}:${minutes.toString().padStart(2, "0")}:${seconds
          .toString()
          .padStart(2, "0")}`;
      }

      function resetTimerDisplay() {
        startBtn.disabled = false;
        stopBtn.disabled = true;
        timerDisplay.setAttribute("contenteditable", "true");
        timerDisplay.textContent = "00:00:00";
      }


// Handle typing inside the timer
timerDisplay.addEventListener("input", (event) => {
  let content = timerDisplay.textContent.replace(/\D/g, ""); // Remove non-digit characters

  // Limit to 6 digits (HHMMSS)
  content = content.slice(0, 6).padEnd(6, "0");

  // Format as HH:MM:SS
  let hours = content.slice(0, 2);
  let minutes = content.slice(2, 4);
  let seconds = content.slice(4, 6);

  // Ensure time doesn't exceed 99:59:59
  if (parseInt(hours) > 99) {
    hours = "99";
  }
  if (parseInt(minutes) > 59) {
    minutes = "59";
  }
  if (parseInt(seconds) > 59) {
    seconds = "59";
  }

  // Save the current caret position
  const selection = window.getSelection();
  const caretPos = selection.anchorOffset;

  // Update the text content
  timerDisplay.textContent = `${hours}:${minutes}:${seconds}`;

  // Restore the caret position based on the input
  const newCaretPos = Math.min(caretPos, timerDisplay.textContent.length);
  const range = document.createRange();
  range.setStart(timerDisplay.lastChild, newCaretPos);
  range.setEnd(timerDisplay.lastChild, newCaretPos);
  
  // Set the caret at the correct position
  selection.removeAllRanges();
  selection.addRange(range);

  // Prevent input if the total characters exceed the limit
  if (content.length >= 6) {
    event.preventDefault();
  }
});











      // Validate input on blur
      timerDisplay.addEventListener("blur", () => {
        const enteredTime = timerDisplay.textContent.trim();
        if (!/^\d{2}:\d{2}:\d{2}$/.test(enteredTime)) {
          resetTimerDisplay();
        }
      });
    </script>
  </body>
</html>
